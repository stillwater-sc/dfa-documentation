<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=generator content="Relearn 5.10.2+tip"><meta name=description content="Introduction and educational site for the design and optimization of parallel domain flow algorithms"><meta name=author content="E. Theodore L. Omtzigt"><title>An Example - Domain Flow Architecture</title><link href=../../images/favicon.png?1675271544 rel=icon type=image/png><link href=../../css/fontawesome-all.min.css?1675271544 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fontawesome-all.min.css?1675271544 rel=stylesheet></noscript><link href=../../css/featherlight.min.css?1675271544 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/featherlight.min.css?1675271544 rel=stylesheet></noscript><link href=../../css/auto-complete.css?1675271544 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/auto-complete.css?1675271544 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar.min.css?1675271544 rel=stylesheet><link href=../../css/nucleus.css?1675271544 rel=stylesheet><link href=../../css/fonts.css?1675271544 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fonts.css?1675271544 rel=stylesheet></noscript><link href=../../css/theme.css?1675271544 rel=stylesheet><link href=../../css/theme-blue.css?1675271544 rel=stylesheet id=variant-style><link href=../../css/ie.css?1675271544 rel=stylesheet><link href=../../css/variant.css?1675271544 rel=stylesheet><link href=../../css/print.css?1675271544 rel=stylesheet media=print><script src=../../js/url.js?1675271544></script>
<script src=../../js/variant.js?1675271544></script>
<script>window.index_json_url="../../index.json";var root_url="../../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://stillwater-sc.github.io/domain-flow/",window.variants&&variants.init(["blue","green","red","relearn-light","relearn-dark"])</script><script src=../../js/jquery.min.js?1675271544 defer></script></head><body class="mobile-support html" data-url=../../introduction/example/index.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable dir=ltr><div><div class=navigation><span class="nav nav-next"><i class="fa fa-chevron-right fa-fw"></i></span></div><div class=navigation><a class="nav nav-prev" href=../../index.html title="Domain Flow Architecture (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>Domain Flow Architecture</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../introduction/index.html><span itemprop=name>Getting Started</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>An Example</span><meta itemprop=position content="3"></li></ol></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><div id=head-tags><div class=tags><a class=tag-link href=../../tags/algorithm/index.html>algorithm</a>
<a class=tag-link href=../../tags/domain-flow/index.html>domain-flow</a>
<a class=tag-link href=../../tags/matrix-multiply/index.html>matrix-multiply</a></div></div><h1 id=an-example>An Example</h1><p>Let&rsquo;s look at a simple, but frequently used operator in Deep Learning inference:
dense matrix multiplication.
A Domain Flow program for this operator is shown below:</p><pre tabindex=0><code class=language-verbatim data-lang=verbatim>compute ( (i,j,k) | 1 &lt;= i,j,k &lt;= N ) {
    a: a[i,j-1,k]
    b: b[i-1,j,k]
    c: c[i,j,k-1] + a[i,j-1,k] * b[i-1,j,k]
} 
</code></pre><p>The underlying algorithm requires a domain of computation governed by a set of constraints, and a set
of computational dependencies that implicitly define a partial order across all the operations in the
computation. The partial order is readily visible in the need to have computed the result for
<span class="math align-center">$c[i,j,k-1]$</span> before the computation
of
<span class="math align-center">$c[i,j,k]$</span> can commence.
In contrast, the
<span class="math align-center">$a$</span> and
<span class="math align-center">$b$</span> recurrences are
independent of each other.</p><p>From a design perspective, an explicit dependency enables us to &lsquo;order&rsquo; the nodes in a computational graph.
This can be done in time, as is customary in sequential programming: the sequence of
instructions is a constraint to order the operations in time and enable an unambiguious semantic
interpretation of the value of a variable even though that variable may be reused.
Parallel algorithms offer more degrees of freedom to order the computational events. In addition to
sequential order, we can also disambiguate variables in space. For high-performant parallel computation,
we are looking for partial orders, or <a href=https://en.wikipedia.org/wiki/Partially_ordered_set target=_blank>posets</a>,
where independent computational events are spatially separated
in space, and where dependent events are spatially &lsquo;close&rsquo;.</p><p>If we look back again at the domain flow code of matrix multiply, we observe that all results
are assigned to a unique variable. This is called <em>Single Assignment Form</em> (SAF), and this yields a
computational graph that makes all computational dependencies explicit.</p><p>The second observation is that the computational events are made unique with a variable name and
an index tag, represented by
<span class="math align-center">$[i,j,k]]$</span>.
The constraint set:
<span class="math align-center">$compute ( (i,j,k) | 1 <= i,j,k <= N )$</span>,
carves out a subset in the lattice
<span class="math align-center">$N^3$</span>,
and the body defines the computational events at each of the lattice points
<span class="math align-center">$[i,j,k]$</span> contained in the subset.</p><p>Thirdly, dependencies between computational events are specified by an index expression.
The statement
<span class="math align-center">$a: a[i,j-1,k]$</span> is a shorthand for
<span class="math align-center">$a: a[i,j,k] => a[i,j,k] = a[i,j-1,k]$</span>,
defining a dependency to the value at
<span class="math align-center">$[i,j-1,k]$</span> for each lattice point
where the variable
<span class="math align-center">$a$</span> is defined.</p><p>A thorough understanding of the partial and total orders inherent in the
parallel computation is essential for finding optimal domain flow algorithms.</p><p>High-performance, low-power execution patterns frequently involve a partial order that enables
timely reuse of computational results, or creates flexibility to organize just-in-time arrival
of input operands to avoid memory elements.</p><p>In the next segment, let&rsquo;s explore these execution patterns.</p></div></main></div><aside id=sidebar class="default-animation showVisitedLinks" dir=ltr><div id=header-wrapper class=default-animation><div id=header class=default-animation><a href=https://stillwater-sc.github.io/domain-flow><img src=https://stillwater-sc.github.io/domain-flow/images/stillwater-logo.png alt="Stillwater Supercomputing, Inc."></a></div><form action=../../search.html method=get><div class="searchbox default-animation"><button type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=search-by>Search</label>
<input data-search-input id=search-by name=search-by class=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div></form><script>var contentLangs=["en"]</script><script src=../../js/auto-complete.js?1675271544 defer></script>
<script src=../../js/lunr/lunr.min.js?1675271544 defer></script>
<script src=../../js/lunr/lunr.stemmer.support.min.js?1675271544 defer></script>
<script src=../../js/lunr/lunr.multi.min.js?1675271544 defer></script>
<script src=../../js/lunr/lunr.en.min.js?1675271544 defer></script>
<script src=../../js/search.js?1675271544 defer></script></div><div id=content-wrapper class=highlightable><ul class=topics><li data-nav-id=/introduction/index.html class="dd-item parent alwaysopen"><a href=../../introduction/index.html>Getting Started<i class="fas fa-check read-icon"></i></a><ul id=subsections-db5db1cf4b1800282ddcebf5cde99c36><li data-nav-id=/introduction/example/index.html class="dd-item active"><a href=../../introduction/example/index.html>An Example<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/parallel-programming/index.html class=dd-item><a href=../../introduction/parallel-programming/index.html>Parallel Programming<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/spacetime/index.html class=dd-item><a href=../../introduction/spacetime/index.html>Spacetime<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/computational-spacetime/index.html class=dd-item><a href=../../introduction/computational-spacetime/index.html>Computational Spacetime<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/domain-flow/index.html class=dd-item><a href=../../introduction/domain-flow/index.html>Domain Flow<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/freeschedule/index.html class=dd-item><a href=../../introduction/freeschedule/index.html>Free Schedule<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/linearschedule/index.html class=dd-item><a href=../../introduction/linearschedule/index.html>Linear Schedules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/derivation/index.html class=dd-item><a href=../../introduction/derivation/index.html>Derivation<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/nextsteps/index.html class=dd-item><a href=../../introduction/nextsteps/index.html>Next Steps<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/webgl/index.html class=dd-item><a href=../../introduction/webgl/index.html>Webgl<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/design/index.html class="dd-item alwaysopen"><a href=../../design/index.html>Elements of Good Design<i class="fas fa-check read-icon"></i></a><ul id=subsections-d25739b54eec6c54b486058b3e2f3701><li data-nav-id=/design/currentstate/index.html class=dd-item><a href=../../design/currentstate/index.html>Algorithm Dynamics<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/elements/index.html class=dd-item><a href=../../design/elements/index.html>Elements of Design<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/dfm/index.html class=dd-item><a href=../../design/dfm/index.html>Data Flow Machine<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/time/index.html class=dd-item><a href=../../design/time/index.html>Time: the when<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/space/index.html class=dd-item><a href=../../design/space/index.html>Space: the where<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/nextsteps/index.html class=dd-item><a href=../../design/nextsteps/index.html>Next Steps<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/blas/index.html class="dd-item alwaysopen"><a href=../../blas/index.html>Basic Linear Algebra<i class="fas fa-check read-icon"></i></a><ul id=subsections-c04c91366fb5eba2efaaddab304f1204><li data-nav-id=/blas/level1/index.html class=dd-item><a href=../../blas/level1/index.html>BLAS Level 1<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/blas/level2/index.html class=dd-item><a href=../../blas/level2/index.html>BLAS Level 2<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/blas/level3/index.html class=dd-item><a href=../../blas/level3/index.html>BLAS Level 3<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/factorization/index.html class="dd-item alwaysopen"><a href=../../factorization/index.html>Matrix Factorization<i class="fas fa-check read-icon"></i></a><ul id=subsections-ad68331fc764b7acec0f1f237c6522bf><li data-nav-id=/factorization/factorization/index.html class=dd-item><a href=../../factorization/factorization/index.html>Matrix Factorizations<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/matrixkernels/index.html class="dd-item alwaysopen"><a href=../../matrixkernels/index.html>Matrix Kernels<i class="fas fa-check read-icon"></i></a><ul id=subsections-7c2bfc25d3abc9a62b3397c74cd33be7><li data-nav-id=/matrixkernels/matrixkernels/index.html class=dd-item><a href=../../matrixkernels/matrixkernels/index.html>Matrix Kernels<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/linearsolvers/index.html class="dd-item alwaysopen"><a href=../../linearsolvers/index.html>Linear Solvers<i class="fas fa-check read-icon"></i></a><ul id=subsections-5d80ff15816d384ff301e1b89749e656><li data-nav-id=/linearsolvers/solvers/index.html class=dd-item><a href=../../linearsolvers/solvers/index.html>Linear Solvers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/linearsolvers/lu/index.html class=dd-item><a href=../../linearsolvers/lu/index.html>Gaussian Elimination<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showVisitedLinks showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showVisitedLinks showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVariantSwitch showVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><div class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-language>Language</label>
<select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></div></li><li id=select-variant-container class="footerVariantSwitch showVariantSwitch"><div class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-variant>Theme</label>
<select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=blue value=blue selected>Blue</option><option id=green value=green>Green</option><option id=red value=red>Red</option><option id=relearn-light value=relearn-light>Relearn Light</option><option id=relearn-dark value=relearn-dark>Relearn Dark</option></select></div><div class=select-clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><button class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i> Clear History</button></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=../../js/clipboard.min.js?1675271544 defer></script>
<script src=../../js/perfect-scrollbar.min.js?1675271544 defer></script>
<script src=../../js/featherlight.min.js?1675271544 defer></script>
<script>function useMathJax(e){if(!Object.assign)return;window.MathJax=Object.assign(window.MathJax||{},{loader:{load:["[tex]/mhchem"]},startup:{elements:[".math"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]]},options:{enableMenu:!1}},e)}useMathJax(JSON.parse("{}"))</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<script src=../../js/theme.js?1675271544 defer></script></body></html>