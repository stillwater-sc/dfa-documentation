<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=generator content="Relearn 5.10.2+tip"><meta name=description content="Introduction and educational site for the design and optimization of parallel domain flow algorithms"><meta name=author content="E. Theodore L. Omtzigt"><title>Domain Flow - Domain Flow Architecture</title><link href=../../images/favicon.png?1675539154 rel=icon type=image/png><link href=../../css/fontawesome-all.min.css?1675539154 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fontawesome-all.min.css?1675539154 rel=stylesheet></noscript><link href=../../css/featherlight.min.css?1675539154 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/featherlight.min.css?1675539154 rel=stylesheet></noscript><link href=../../css/auto-complete.css?1675539154 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/auto-complete.css?1675539154 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar.min.css?1675539154 rel=stylesheet><link href=../../css/nucleus.css?1675539154 rel=stylesheet><link href=../../css/fonts.css?1675539154 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fonts.css?1675539154 rel=stylesheet></noscript><link href=../../css/theme.css?1675539154 rel=stylesheet><link href=../../css/theme-blue.css?1675539154 rel=stylesheet id=variant-style><link href=../../css/ie.css?1675539154 rel=stylesheet><link href=../../css/variant.css?1675539154 rel=stylesheet><link href=../../css/print.css?1675539154 rel=stylesheet media=print><script src=../../js/url.js?1675539154></script>
<script src=../../js/variant.js?1675539154></script>
<script>window.index_json_url="../../index.json";var root_url="../../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://stillwater-sc.github.io/domain-flow/",window.variants&&variants.init(["blue","green","red","relearn-light","relearn-dark"])</script><script src=../../js/jquery.min.js?1675539154 defer></script></head><body class="mobile-support html" data-url=../../introduction/domain-flow/index.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable dir=ltr><div><div class=navigation><a class="nav nav-next" href=../../introduction/freeschedule/index.html title="Free Schedule (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev" href=../../introduction/computational-spacetime/index.html title="Computational Spacetime (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../index.html><span itemprop=name>Domain Flow Architecture</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../introduction/index.html><span itemprop=name>Domain Flow Algorithms</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Domain Flow</span><meta itemprop=position content="3"></li></ol></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><div id=head-tags><div class=tags><a class=tag-link href=../../tags/domain-flow/index.html>domain-flow</a>
<a class=tag-link href=../../tags/index-space/index.html>index-space</a>
<a class=tag-link href=../../tags/lattice/index.html>lattice</a>
<a class=tag-link href=../../tags/matrix-multiply/index.html>matrix-multiply</a></div></div><article class=default><h1 id=domain-flow>Domain Flow</h1><script src=https://stillwater-sc.github.io/domain-flow/js/Detector.js></script>
<script src=https://stillwater-sc.github.io/domain-flow/js/libs/numeric-1.2.6.js></script>
<script type=x-shader/x-vertex id=vertexshader>
			attribute float size;
			attribute vec3 customColor;
			varying vec3 vColor;
			void main() {
				vColor = customColor;
				vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
				gl_PointSize = size * ( 300.0 / -mvPosition.z );
				gl_Position = projectionMatrix * mvPosition;
			}
		</script><script type=x-shader/x-fragment id=fragmentshader>
			uniform vec3 color;
			uniform sampler2D texture;
			varying vec3 vColor;
			void main() {
				gl_FragColor = vec4( color * vColor, 1.0 );
				gl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord );
				if ( gl_FragColor.a &lt; ALPHATEST ) discard;
			}
		</script><script async src=https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js></script>
<script type=importmap>
			{
				"imports": {
					"three": "https://stillwater-sc.github.io/domain-flow/js/build/three.module.js",
					"three/addons/": "https://stillwater-sc.github.io/domain-flow/js/"
				}
			}
		</script><script type=module>
            import * as THREE from 'three';

            import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

            if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

            let scenes = [];
            var views = [];
            var t, canvas, renderer;
            var PARTICLE_SIZE = 2;
            var clock = new THREE.Clock( true );

            window.onload = init;
            function createIndexSpaceGeometry( N, M, K, cellSize, center, matmul ) {
                    let lattice = { vertices: [] };

                    if (center) {
                            for ( let i = -N/2; i <= N/2; i++ ) {
                                    for ( let j = -M/2; j <= M/2; j++ ) {
                                            for ( let k = -K/2; k <= K/2; k++ ) {
                                                    lattice.vertices.push( new THREE.Vector3( i * cellSize, j * cellSize, k * cellSize ) );
                                            }
                                    }
                            }
                    } else {
                            for ( let i = 0; i < N; i++ ) {
                                    for ( let j = 0; j < M; j++ ) {
                                            for ( let k = 0; k < K; k++ ) {
                                                    if (matmul) {
                                                            
                                                            lattice.vertices.push( new THREE.Vector3( i * cellSize, j * cellSize, k * cellSize ) );
                                                            lattice.vertices.push( new THREE.Vector3( i * cellSize, j * cellSize, k * cellSize ) );
                                                            lattice.vertices.push( new THREE.Vector3( i * cellSize, j * cellSize, k * cellSize ) );
                                                    } else {
                                                            lattice.vertices.push( new THREE.Vector3( i * cellSize, j * cellSize, k * cellSize ) );
                                                    }
                                            }
                                    }
                            }
                    }

                    return lattice;
            }

            function createIndexSpaceScene( lattice, pointSize ) {
                    let scene = new THREE.Scene();
                    
                    let vertices = lattice.vertices;

                    let positions = new Float32Array( vertices.length * 3 );
                    let colors    = new Float32Array( vertices.length * 3 );
                    let sizes     = new Float32Array( vertices.length );

                    let vertex;
                    let color = new THREE.Color();

                    let hue = 0.11;
                    for ( let i = 0, l = vertices.length; i < l; i++ ) {
                            vertex = vertices[i];
                            vertex.toArray( positions, i * 3 );

                            
                            color.setHSL( hue, 1.0, 0.5 );
                            color.toArray( colors, i * 3 );

                            sizes[ i ] = pointSize;
                    }

                    let geometry = new THREE.BufferGeometry();
                    geometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );
                    geometry.setAttribute( 'customColor', new THREE.BufferAttribute( colors, 3 ) );
                    geometry.setAttribute( 'size', new THREE.BufferAttribute( sizes, 1 ) );

                    let material = new THREE.ShaderMaterial( {
                            uniforms: {
                                    color:    { value: new THREE.Color( 0xffffff ) },
                                    texture:  { value: new THREE.TextureLoader().load( "../../textures/sprites/ball.png" ) }
                            },

                            vertexShader: document.getElementById( 'vertexshader' ).textContent,
                            fragmentShader: document.getElementById( 'fragmentshader' ).textContent,

                            alphaTest: 0.9
                    } );

                    let particles = new THREE.Points( geometry, material );
                    scene.add( particles );

                    return scene;
            }

            function init() {
                canvas = document.getElementById( 'c' );

                renderer = new THREE.WebGLRenderer( { canvas: canvas, antialias: true } );
                renderer.setClearColor( 0xffffff );
                renderer.setPixelRatio( window.devicePixelRatio );

                let renderTarget = "index_space_view";
                views.push( document.getElementById( renderTarget ) );

                { 
                    let lattice0 = createIndexSpaceGeometry(20, 20, 20, 1, true);
                    let pointSize0 = PARTICLE_SIZE * 0.5;
                    let scene0 = createIndexSpaceScene( lattice0, pointSize0 );
                    scene0.userData.view = views[0];

                    
                    let camera0 = new THREE.PerspectiveCamera( 75, 1, 0.1, 1000 );
                    camera0.position.set( 0, 0, 25 );   
                    scene0.userData.camera = camera0;

                    let controls0 = new OrbitControls( camera0, views[0] );
                    controls0.minDistance = 20;   
                    controls0.maxDistance = 500;   
                    scene0.userData.controls = controls0;

                    scenes.push( scene0 );
                }

                t = 0;
                animate();

            }

            function updateSize() {
                var width = canvas.clientWidth;
                var height = canvas.clientHeight;

                if ( canvas.width !== width || canvas.height != height ) {
                    renderer.setSize( width, height, false );
                }
            }

            function animate() {
                render();
                requestAnimationFrame( animate );
            }

            function render() {
                updateSize();

                
                renderer.setClearColor( 0xffffff );
                renderer.setScissorTest( false );
                renderer.clear();

                renderer.setClearColor( 0x000000 );
                renderer.setScissorTest( true );

                scenes.forEach( function( scene ) {

                    var rect = scene.userData.view.getBoundingClientRect();
                    
                    if ( rect.bottom < 0 || rect.top  > renderer.domElement.clientHeight ||
                        rect.right  < 0 || rect.left > renderer.domElement.clientWidth ) {
                        return;  
                    }

                    
                    var width  = rect.right - rect.left;
                    var height = rect.bottom - rect.top;
                    var left   = rect.left;
                    var bottom = renderer.domElement.clientHeight - rect.bottom;
                    renderer.setViewport( left, bottom, width, height );
                    renderer.setScissor( left, bottom, width, height );

                    renderer.render( scene, scene.userData.camera );

                    scene.children[0].geometry.verticesNeedUpdate = true;

                } );

                t = clock.getElapsedTime();
            }

        </script><p>Domain flow is an abstract parallel programming model that is invariant to technology changes.</p><p>An equation
<span class="math align-center">$c = a \oplus b$</span> is comprised of a computation phase,
the
<span class="math align-center">$\oplus$</span>,
and a communication phase, the
<span class="math align-center">$=$</span>.</p><p>Implementation technology will impact these phases differently, and we are seeking a programming model
that is invariant to the difference. A thought experiment will shed light on the desired properties of such a model.</p><p>In the extreme, if the two delays are very different, then the physical execution will either be computation-bound,
or communication-bound. In either case, there is limited concurrency.
If our technology delivers a ten-fold improvement in computation time, any dependent computational event needs
to come ten times closer to maintain the same balance. If the communication phase does not improve,
the computation resource will now be 90% idle as it is waiting for operands to be delivered.
Our 10x technology improvement in computational performance would deliver only a 2x system-level improvement.</p><p>Maximum concurrency emerges when the two delays are similar and can overlap each other.
When the computation and communication phases are balanced we can deliver 100% resource
utilization and maximum concurrency: all the electrons in the system are wiggling to affect some result.</p><p>Now, imagine that we have as many computational resources as there are nodes in the computational graph.
In that case, we could simply embed the computational graph in free space.
However, a physical machine will have some physical extent, and a collection of manufactured computational nodes will
fill free space in some &lsquo;regular&rsquo;, crystalline pattern.
These crystalline patterns are typically referred to as a <em>lattice</em>. When engineering these structures, we can
balance the computation and communication delays through simple area-time trade-offs. This presents the invariance
we are seeking. Independent of technology, we can always engineer a machine that offers balance between
computation and communication delays, and that offers connectivity among nodes that fall within the future cone of the
computational spacetime.</p><p>One such computational spacetime that is uniform in all directions is the Cartesian lattice,
<span class="math align-center">$\mathbb{N}^3$</span>.
And the design of a domain flow algorithm is the act of finding an efficient embedding of the
computational graph of the single assignment form in the Cartesian lattice,
<span class="math align-center">$\mathbb{N}^c$</span>.</p><p>Back to our matrix multiply; we can now reinterpret the domain flow algorithm as an embedding.
Each index range, that is, the
<span class="math align-center">$i, j, k$</span> in the constraint set, can be seen as a dimension in
the Cartesian lattice. The index tag, such as
<span class="math align-center">$[i,j,k]$</span>, is a location in the lattice.</p><p>This is what the lattice for matmul looks like for a given
<span class="math align-center">$N$</span>:</p><p><canvas id=c></canvas></p><div id=index_space_view></div><footer class=footline></footer></article></div></main></div><aside id=sidebar class="default-animation showVisitedLinks" dir=ltr><div id=header-wrapper class=default-animation><div id=header class=default-animation><a href=https://stillwater-sc.github.io/domain-flow><img src=https://stillwater-sc.github.io/domain-flow/images/stillwater-logo.png alt="Stillwater Supercomputing, Inc."></a></div><form action=../../search.html method=get><div class="searchbox default-animation"><button type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=search-by>Search</label>
<input data-search-input id=search-by name=search-by class=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div></form><script>var contentLangs=["en"]</script><script src=../../js/auto-complete.js?1675539154 defer></script>
<script src=../../js/lunr/lunr.min.js?1675539154 defer></script>
<script src=../../js/lunr/lunr.stemmer.support.min.js?1675539154 defer></script>
<script src=../../js/lunr/lunr.multi.min.js?1675539154 defer></script>
<script src=../../js/lunr/lunr.en.min.js?1675539154 defer></script>
<script src=../../js/search.js?1675539154 defer></script></div><div id=content-wrapper class=highlightable><ul class=topics><li data-nav-id=/introduction/index.html class="dd-item parent alwaysopen"><a href=../../introduction/index.html>Domain Flow Algorithms<i class="fas fa-check read-icon"></i></a><ul id=subsections-db5db1cf4b1800282ddcebf5cde99c36><li data-nav-id=/introduction/example/index.html class=dd-item><a href=../../introduction/example/index.html>An Example<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/parallel-programming/index.html class=dd-item><a href=../../introduction/parallel-programming/index.html>Parallel Programming<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/spacetime/index.html class=dd-item><a href=../../introduction/spacetime/index.html>Spacetime<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/computational-spacetime/index.html class=dd-item><a href=../../introduction/computational-spacetime/index.html>Computational Spacetime<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/domain-flow/index.html class="dd-item active"><a href=../../introduction/domain-flow/index.html>Domain Flow<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/freeschedule/index.html class=dd-item><a href=../../introduction/freeschedule/index.html>Free Schedule<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/linearschedule/index.html class=dd-item><a href=../../introduction/linearschedule/index.html>Linear Schedules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/derivation/index.html class=dd-item><a href=../../introduction/derivation/index.html>Derivation<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/wavefront/index.html class=dd-item><a href=../../introduction/wavefront/index.html>Wavefronts of Computation<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/introduction/nextsteps/index.html class=dd-item><a href=../../introduction/nextsteps/index.html>Next Steps<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/design/index.html class="dd-item alwaysopen"><a href=../../design/index.html>Elements of Good Design<i class="fas fa-check read-icon"></i></a><ul id=subsections-d25739b54eec6c54b486058b3e2f3701><li data-nav-id=/design/currentstate/index.html class=dd-item><a href=../../design/currentstate/index.html>Algorithm Dynamics<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/elements/index.html class=dd-item><a href=../../design/elements/index.html>Elements of Design<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/dfm/index.html class=dd-item><a href=../../design/dfm/index.html>Data Flow Machine<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/time/index.html class=dd-item><a href=../../design/time/index.html>Time: the when<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/space/index.html class=dd-item><a href=../../design/space/index.html>Space: the where<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/design/nextsteps/index.html class=dd-item><a href=../../design/nextsteps/index.html>Next Steps<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/blas/index.html class="dd-item alwaysopen"><a href=../../blas/index.html>Basic Linear Algebra<i class="fas fa-check read-icon"></i></a><ul id=subsections-c04c91366fb5eba2efaaddab304f1204><li data-nav-id=/blas/level1/index.html class=dd-item><a href=../../blas/level1/index.html>BLAS Level 1<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/blas/level2/index.html class=dd-item><a href=../../blas/level2/index.html>BLAS Level 2<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/blas/level3/index.html class=dd-item><a href=../../blas/level3/index.html>BLAS Level 3<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/factorization/index.html class="dd-item alwaysopen"><a href=../../factorization/index.html>Matrix Factorization<i class="fas fa-check read-icon"></i></a><ul id=subsections-ad68331fc764b7acec0f1f237c6522bf><li data-nav-id=/factorization/factorization/index.html class=dd-item><a href=../../factorization/factorization/index.html>Matrix Factorizations<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/matrixkernels/index.html class="dd-item alwaysopen"><a href=../../matrixkernels/index.html>Matrix Kernels<i class="fas fa-check read-icon"></i></a><ul id=subsections-7c2bfc25d3abc9a62b3397c74cd33be7><li data-nav-id=/matrixkernels/matrixkernels/index.html class=dd-item><a href=../../matrixkernels/matrixkernels/index.html>Matrix Kernels<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/linearsolvers/index.html class="dd-item alwaysopen"><a href=../../linearsolvers/index.html>Linear Solvers<i class="fas fa-check read-icon"></i></a><ul id=subsections-5d80ff15816d384ff301e1b89749e656><li data-nav-id=/linearsolvers/solvers/index.html class=dd-item><a href=../../linearsolvers/solvers/index.html>Linear Solvers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/linearsolvers/lu/index.html class=dd-item><a href=../../linearsolvers/lu/index.html>Gaussian Elimination<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/contentdev/index.html class="dd-item alwaysopen"><a href=../../contentdev/index.html>Content Development<i class="fas fa-check read-icon"></i></a><ul id=subsections-d21e4297ce5ab9b266fb06efa131e45d><li data-nav-id=/contentdev/prototype/index.html class=dd-item><a href=../../contentdev/prototype/index.html>Prototype<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showVisitedLinks showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showVisitedLinks showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVariantSwitch showVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><div class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-language>Language</label>
<select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></div></li><li id=select-variant-container class="footerVariantSwitch showVariantSwitch"><div class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-variant>Theme</label>
<select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=blue value=blue selected>Blue</option><option id=green value=green>Green</option><option id=red value=red>Red</option><option id=relearn-light value=relearn-light>Relearn Light</option><option id=relearn-dark value=relearn-dark>Relearn Dark</option></select></div><div class=select-clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><button class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i> Clear History</button></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=../../js/clipboard.min.js?1675539154 defer></script>
<script src=../../js/perfect-scrollbar.min.js?1675539154 defer></script>
<script src=../../js/featherlight.min.js?1675539154 defer></script>
<script>function useMathJax(e){if(!Object.assign)return;window.MathJax=Object.assign(window.MathJax||{},{loader:{load:["[tex]/mhchem"]},startup:{elements:[".math"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]]},options:{enableMenu:!1}},e)}useMathJax(JSON.parse("{}"))</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<script src=../../js/jquery.svg.pan.zoom.js?1675539154 defer></script>
<script src=https://unpkg.com/mermaid/dist/mermaid.min.js defer></script>
<script>window.themeUseMermaid=JSON.parse('{ "theme": "default" }')</script><script src=https://unpkg.com/rapidoc/dist/rapidoc-min.js defer></script>
<script>window.themeUseSwagger=JSON.parse('{ "theme": "light" }')</script><script src=../../js/theme.js?1675539154 defer></script></body></html>